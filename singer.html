<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>가수</title>
  <link rel="stylesheet" href="singer.css" />
</head>
<body>
  <div class="container">
    <!-- 배경 -->
    <img src="images/background3.png" alt="배경" class="bg-img" />

    <!-- 🔹 상단 좌측 돌아가기 버튼 -->
    <a href="choice.html" class="back-btn">다른 직업 알아보기</a>

    <!-- 콘텐츠 래퍼: 위층(좌우) + 아래층(입력바) -->
    <div class="content-wrap">
      <!-- 위층: 좌우 분할 -->
      <section class="top-row">
        <div class="left-panel">
          <img src="images/가수2.png" alt="가수 캐릭터" class="character-img" />
        </div>

        <!-- 우측 패널 -->
        <div class="right-panel">
          <!-- 우측 보드: 말풍선 + 3x2 질문 버튼 (absolute) -->
          <div class="right-board">
            <!-- 말풍선 이미지 -->
            <img src="images/말풍선.png" alt="말풍선" class="bubble" />

            <!-- 말풍선 텍스트 (초기 문구) -->
            <div id="bubble-text" class="bubble-text">
              가수는 노래로 사람들에게 즐거움과 감동을 주는 직업입니다.
            </div>

            <!-- 질문 버튼 3x2 (클릭 시 고정 답변 표시) -->
            <a href="#" class="qbtn q1"
               data-answer="가수가 되려면 노래하는 방법과 음악을 공부해야 해요.악기나 무대 경험도 있으면 좋아요.꾸준히 연습하는 습관이 필요해요.">
              <img src="images/질문1.png" alt="질문1" />
            </a>

            <a href="#" class="qbtn q2"
               data-answer="매일 노래를 연습하고 무대를 준비해요.공연장에서 노래하거나 녹음실에서 음반을 만들어요.팬들을 위해 바쁘게 움직여요.">
              <img src="images/질문2.png" alt="질문2" />
            </a>

            <a href="#" class="qbtn q3"
               data-answer="목이 아프거나 몸이 피곤할 때도 노래해야 해서 힘들어요.무대에서 긴장될 때가 많아요.연습을 계속해야 하는 것도 쉽지 않아요.">
              <img src="images/질문3.png" alt="질문3" />
            </a>

            <a href="#" class="qbtn q4"
               data-answer="관객이 노래를 듣고 함께 따라 부르거나 즐거워할 때 뿌듯해요.사람들이 감동받아 눈물을 흘릴 때도 있어요.내 노래가 사람들에게 힘이 된다는 걸 느껴요.">
              <img src="images/질문4.png" alt="질문4" />
            </a>

            <a href="#" class="qbtn q5"
               data-answer="노래로 즐거움과 위로를 줄 수 있어요.사람들의 마음을 밝게 만들 수 있어요.모두에게 행복을 나눠줄 수 있는 직업이에요.">
              <img src="images/질문5.png" alt="질문5" />
            </a>

            <a href="#" class="qbtn q6"
               data-answer="음악을 사랑하는 마음이 필요해요.꾸준히 연습하려는 인내심이 있어야 해요.팬들을 소중히 여기는 따뜻한 마음도 필요해요.">
              <img src="images/질문6.png" alt="질문6" />
            </a>
          </div>
        </div>
      </section>

      <!-- 아래층: 전체 폭 입력바 -->
      <section class="bottom-row">
        <div class="input-label">궁금한 내용을<br>직접 써보세요</div>
        <input type="text" class="input-box" placeholder="여기에 입력하세요..." />
        <button class="send-btn">전송</button>
      </section>
    </div>
  </div>

  <!-- 스크립트: ① 고정답 표시 ② 전송시 GPT 호출 -->
  <script>
    // ① 질문 버튼: 고정된 답변을 말풍선에 표시
    document.querySelectorAll('.qbtn').forEach(btn => {
      btn.addEventListener('click', e => {
        e.preventDefault();
        const answer = btn.getAttribute('data-answer');
        const bubble = document.getElementById('bubble-text');
        bubble.innerHTML = answer; //  줄바꿈 유지
      });
    });

    // ② 전송 버튼: 입력한 질문을 GPT에 보내고 말풍선에 표시
    const sendBtn = document.querySelector('.send-btn');
    const inputBox = document.querySelector('.input-box');
    const bubbleText = document.getElementById('bubble-text');

    // ⚠️ 실습용: API 키를 직접 코드에 포함 (배포용으론 비권장)
    const API_KEY = "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"; // ← 실제 키로 교체

    async function askAI(question) {
      try {
        // 로딩 표시
        bubbleText.innerHTML = "답변을 생성 중이에요...";

        const res = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${API_KEY}`
          },
          body: JSON.stringify({
            model: "gpt-3.5-turbo",
            messages: [
              { role: "system", content: "너는 초등학생을 대상으로 직업을 설명해주는 친절한 선생님이야. 답변은 2~3문장 정도로 짧고 알기 쉽게 말해줘. 어려운 전문 용어는 쓰지 말고, 쉬운 단어와 친근한 말투를 사용해. 설명할 때는 마치 아이와 대화하듯 따뜻하게 말하고, ." },
              { role: "user", content: question }
            ],
            max_tokens: 300,
            temperature: 0.7
          })
        });

        const data = await res.json();
        const answer = data?.choices?.[0]?.message?.content || "답변이 비어있어요.";
        bubbleText.innerHTML = answer.replace(/\n/g, "");
      } catch (e) {
        console.error(e);
        bubbleText.innerHTML = "오류가 발생했어요. 잠시 후 다시 시도해주세요.";
      }
    }

    // 전송 버튼 클릭
    sendBtn.addEventListener('click', () => {
      const q = inputBox.value.trim();
      if (!q) return;
      askAI(q);
    });

    // 엔터키도 전송
    inputBox.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        const q = inputBox.value.trim();
        if (q) askAI(q);
      }
    });
  </script>
</body>
</html>

